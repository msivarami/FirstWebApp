<?xml version="1.0" encoding="utf-8" ?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <Configuration Condition=" '$(Configuration)' == '' ">Release</Configuration>
        <SolutionName>MyWebApp</SolutionName>
        <SolutionFile>$(SolutionName).sln</SolutionFile>
        <ProjectName>MyWebApp</ProjectName>
        <ProjectFile>$(ProjectName)\$(ProjectName).csproj</ProjectFile>
    </PropertyGroup>

    <Target Name="Build" DependsOnTargets="BuildPackage;CopyOutput" />

    <Target Name="BuildPackage">
        <MSBuild Projects="$(SolutionFile)" ContinueOnError="false" Targets="Rebuild" Properties="Configuration=$(Configuration)" />
        <MSBuild Projects="$(ProjectFile)" ContinueOnError="false" Targets="Package" Properties="Configuration=$(Configuration)" />
    </Target>

    <Target Name="CopyOutput">
        <ItemGroup>
            <!-- <PackagedFiles Include="$(ProjectName)\obj\$(Configuration)\Package\PackageTmp\**\*.*"/> -->
        </ItemGroup>
        
    </Target>
	<Import Project="lib\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets" /> 
	<Target Name="Zip"> <CreateItem Include="**\FirstWebAPI\obj\Release\Package\PackageTmp\*.*" > 
	<Output ItemName="ZipFiles" TaskParameter="Include"/> 
	</CreateItem> <Zip ZipFileName="FirstWebAPI.zip" WorkingDirectory="PackageTmp" Files="@(ZipFiles)" /> 
	</Target>
</Project>
